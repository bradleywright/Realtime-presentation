<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Programming the real time web</title>
  <!-- Apple mobile device handling -->
  <meta name="viewport" content="user-scalable=no, width=device-width">

  <!-- Common dependencies -->
  <script type="text/javascript" src="/modules/Squeenote/public/common/js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="/modules/Squeenote/public/common/js/jquery-ui-1.8.2.custom.min.js"></script>
  <script type="text/javascript" src="/modules/Squeenote/public/common/js/socket.io.js"></script>
  <!-- Squeenote core -->
  <script type="text/javascript" src="/modules/Squeenote/public/common/js/squeenote.device.js"></script>
  <script type="text/javascript" src="/modules/Squeenote/public/common/js/squeenote.presentation.js"></script>
  <script type="text/javascript" src="/modules/Squeenote/public/common/js/squeenote.ui.js"></script>
  <link rel="stylesheet" href="/modules/Squeenote/public/common/css/controls.css" type="text/css" media="screen" title="no title" charset="utf-8">
  <!-- Boot Squeenote -->
  <script type="text/javascript">
    WEB_SOCKET_SWF_LOCATION = "/socket.io/WebSocketMain.swf";
    $(document).ready(function() {
      squeenote.Device = new squeenote.Device();
      squeenote.Presentation = new squeenote.Presentation();
    })
    $(document).bind("presentationLoaded.squeenote", function(event, presentation) {
      squeenote.UI = new squeenote.UI(presentation);
    });
  </script>

  <!-- Theme files -->
  <script type="text/javascript" src="/modules/Squeenote/public/squeenote-default/theme.js"></script>
  <link rel="stylesheet" href="/modules/Squeenote/public/squeenote-default/theme.css" type="text/css" media="screen" title="no title" charset="utf-8">
  <link media="only screen and (min-device-width: 768px) and (max-device-width: 1024px)"
        href="/modules/Squeenote/public/squeenote-default/theme.ext.ipad.css" type="text/css" rel="stylesheet">
  <link media="only screen and (max-device-width: 480px)"
        href="/modules/Squeenote/public/squeenote-default/theme.ext.iphone.css" type="text/css" rel="stylesheet" />
    </head>
    <body>
        <ol>
            <li>
                <h1>Programming the real time web</h1>
                <h2>by <a href="http://intranation.com/">Bradley Wright</a></h2>
            </li>
            <li>
                <h2>Who am I?</h2>
                <ul>
                    <li>Web developer with 10 years experience</li>
                    <li>Former lead front-end developer at Yahoo! Answers</li>
                    <li>Head of Web Development at <a href="http://smarkets.com">Smarkets</a></li>
                    <li><a href="http://twitter.com/intranation">@intranation</a></li>
                </ul>
            </li>
            <li>
                <h2>Overview</h2>
                <ul>
                    <li>What does real time web programming mean?</li>
                    <li>Why would I need or want it for my site?</li>
                    <li>How does it work, including cross browser techniques?</li>
                    <li>Server architecture, including scaling</li>
                    <li>What's "asynchronous programming"?</li>
                    <li>How can this be made accessible?</li>
                </ul>
            </li>
            <li>
                <h2>A short demo...</h2>
                <p>Just visit: <a href="http://dibi2011.intranation.com/">dibi2011.intranation.com</a></p>
            <li>
                <h2>What does "real time web programming" mean?</h2>
                <ul>
                    <li>Client/server communication in <a href="http://en.wikipedia.org/wiki/Real-time_computing">"soft" real time</a></li>
                    <li>Requires Javascript</li>
                    <li>Similar programming model to Ajax - <em>with a few caveats</em></li>
                </ul>
            </li>
            <li>
                <h3>Real world web examples</h3>
                <ul>
                    <li>Google Talk widget in GMail</li>
                    <li><a href="http://meebo.com/">Meebo</a></li>
                    <li><a href="https://irccloud.com/">IRCCloud</a></li>
                    <li>Facebook chat (in browser)</li>
                    <li><a href="http://finance.google.com/">Google Finance</a></li>
                </ul>
             </li>
             <li>
                <h3>Non-web examples</h3>
                <ul>
                    <li>FIX Protocol</li>
                    <li>Erlang message passing</li>
                    <li>Jabber presence notifcations</li>
                    <li>Socket programming</li>
                </ul>
            </li>
            <li>
                <h3>Who really needs it?</h3>
                <ul>
                    <li>Live chat</li>
                    <li>Financial applications</li>
                    <li>Games</li>
                </ul>
            </li>
            <li>
                <h2>Why would I want it?</h2>

            </li>
            <li>
                <h2>How does it work?</h2>
                <ul>
                    <li>The old way</li>
                    <li>The current standard</li>
                    <li>The elephant in the room</li>
                </ul>
            </li>
            <li>
                <h3>An HTTP request</h3>
                <pre>GET /my-ajax-url HTTP/1.1
Host: mywebsite.com
... other stuff here
                </pre>
            </li>
            <li>
                <h3>The old way</h3>
                <h4>Polling</h4>
                <pre>window.setTimeout(function(){$.ajax();}, 2000);</pre>
            </li>
            <li>
                <h3>The old way</h3>
                <h4>Long Polling</h4>
                <ul>
                    <li><strong>Important!</strong> don't do this on a regular Apache server!</li>
                    <li><strong>Long-polling</strong> - Ajax request that waits for server to close connection:
                        <pre>&lt;?php
    // fake waiting for data
    sleep(rand(2,10));
    // send response
    header('Content-type: application/json');
    echo '{"data":"here","key":"value"}';
?&gt;</pre></li>
                </ul>
            </li>
            <li>
                <h3>The old way</h3>
                <h4>Comet</h4>
                <ul>
                    <li>Otherwise known as the <a href="http://svn.cometd.com/trunk/bayeux/bayeux.html">Bayeux protocol</a></li>

                    <li>Long polling with handshake and response verification attached</li>
                    <li>Cross-domain using "callback polling" (JSONP)</li>
                </ul>
            </li>
            <li>
                <h3>The old way</h3>
                <h4>Dynamic script elements</h4>
            </li>
            <li>
                <h3>The old way</h3>
                <h4>Multipart responses</h4>
            </li>
            <li>
                <h3>The old way</h3>
                <h4>Forever iframes</h4>
            </li>
            <li>
                <h2>The current way</h2>
            </li>
            <li>
                <h2>WebSockets</h2>
                <pre>GET /demo HTTP/1.1
Upgrade: WebSocket
Connection: Upgrade
Host: example.com
Origin: http://example.com
Sec-WebSocket-Key1: 4 @1  46546xW%0l 1 5
Sec-WebSocket-Key2: 12998 5 Y3 1  .P00

^n:ds[4U
</pre>
            </li>
            <li>
                <h2>WebSockets security issues</h2>
            </li>
            <li>
                <h2>Future of WebSockets</h2>
            </li>
            <li>
                <h2>Server architecture</h2>
                <h3>Why long polling and Apache don't mix</h3>
            </li>
            <li>
                <h2>Server architecture</h2>
                <h3>Non-blocking servers</h3>
                <ul>
                    <li>High concurrency</li>
                </ul>
            </li>
            <li>
                <h3>Popular servers/libraries capable of this</h3>
                <ul>
                    <li><a href="http://camel.apache.org/cometd.html">Apache cometd</a></li>
                    <li><a href="http://www.tornadoweb.org/">Tornado</a></li>
                    <li><a href="http://www.eventlet.net/">eventlet</a> (<a href="http://eventlet.net/doc/modules/websocket.html">websocket extension</a>)</li>
                    <li><a href="http://twistedmatrix.com/trac/">Twisted</a></li>
                    <li><a href="http://rubyeventmachine.com/">EventMachine</a></li>
                    <li><a href="http://nodejs.org/">node.js</a></li>
                </ul>
            </li>
            <li>
                <h2>Server architecture</h2>
                <h3>Message/work queues</h3>
            </li>
            <li>
                <h2>Scaling server architecture</h2>
                <ul>
                    <li>Stateless workers</li>
                    <li>Scale horizontally</li>
                </ul>
                <ul>
                    <li>Offline processing</li>
                    <li>Bind message queues to each other</li>
                    <li>Frontend acts as dumb router to browser</li>
                    <li>Wire up exchanges dynamically in application layer</li>
                </ul>
            </li>
            <li>
                <h2>Asynchronous programming</h2>
            </li>
            <li>
                <h2>Accessibility</h2>
            </li>
        </ol>
    </body>
</html>
